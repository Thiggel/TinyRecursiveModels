name: recursive_reasoning.trm_mhc@TinyRecursiveReasoningModel_ACTV1
loss:
  name: losses@ACTLossHead
  loss_type: stablemax_cross_entropy

halt_exploration_prob: 0.1
halt_max_steps: 16

H_cycles: 3
L_cycles: 6

H_layers: 0
L_layers: 2

hidden_size: 512
num_heads: 8  # min(2, hidden_size // 64)
expansion: 4

puzzle_emb_ndim: ${.hidden_size}

pos_encodings: rope
forward_dtype: bfloat16

mlp_t: False # use mlp on L instead of transformer
puzzle_emb_len: 16 # if non-zero, its specified to this value
no_ACT_continue: True # No continue ACT loss, only use the sigmoid of the halt which makes much more sense
depth_recurrence: transformer
depth_cell_hidden_size: null
depth_cell_state_size: 64
depth_cell_expand: 1
depth_cell_conv_kernel: 4
depth_cell_layers: null
depth_cell_nonlinearity: tanh
depth_cell_xlstm_chunkwise_kernel: chunkwise--native_autograd
depth_cell_xlstm_sequence_kernel: native_sequence__native
depth_cell_xlstm_step_kernel: native
depth_cell_xlstm_num_heads: null
depth_cell_mamba_impl: mamba2
tbptt_steps: 0

mhc_streams: 4
mhc_sinkhorn_iters: 20
mhc_eps: 1e-6
mhc_sinkhorn_tau: 0.05
mhc_alpha_init: 1e-2
